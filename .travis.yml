sudo: false

language: cpp

compiler:
    - gcc
    - clang

addons:
    apt:
        sources:
            - ubuntu-toolchain-r-test
            - kalakris-cmake
            - boost-latest
            - llvm-toolchain-precise-3.6
        packages:
            - cmake
            - g++-4.9
            - clang-3.6
            - libboost-all-dev
            - xorg-dev
            - libgl1-mesa-dev
            - libopencv-dev
            - libpython2.7-dev

before_install:
    - if [ "$CXX" = "g++" ]; then export CXX="g++-4.9" CC="gcc-4.9"; fi
    - if [ "$CXX" = "clang++" ]; then export CXX="clang++-3.6" CC="clang-3.6"; fi
    - "wget https://github.com/glfw/glfw/archive/3.1.zip && unzip 3.1.zip -d . && cd glfw-3.1 &&
      cmake -DCMAKE_INSTALL_PREFIX=$HOME/glfw3 -DCMAKE_BUILD_TYPE=release -DGLFW_BUILD_DOCS=Off
            -DGLFW_BUILD_EXAMPLES=Off -DGLFW_BUILD_TESTS=Off . &&
      cmake --build . && make install && cd -"
    - "wget https://github.com/erincatto/Box2D/archive/v2.3.1.zip && unzip v2.3.1.zip && cd Box2D-2.3.1/Box2D &&
      cmake -DCMAKE_INSTALL_PREFIX=$HOME/box2d -DCMAKE_BUILD_TYPE=release -DBOX2D_BUILD_EXAMPLES=Off
            -DBOX2D_BUILD_SHARED=On -DBOX2D_BUILD_STATIC=Off . &&
      cmake --build . && make install && cd -"

before_script:
    - mkdir build && cd build
    - export GLFW_LOCATION=$HOME/glfw3
    - export BOX2DDIR=$HOME/box2d
    - cmake -DCMAKE_BUILD_TYPE=debug ..

script:
    - make
